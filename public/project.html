<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[THÃ˜RAX][LAB] | Smart Project View</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=SF+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Variables & Reset */
        :root {
            --thorax-blue: #1A5F7A;
            --thorax-teal: #0D8B70;
            --thorax-purple: #6D5ACF;
            --ui-dark: #1E293B;
            --ui-mid: #64748B;
            --ui-light: #F8FAFC;
            --ui-card: #FFFFFF;
            --ui-border: #E2E8F0;
            --radius: 10px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --clinical: rgba(26, 95, 122, 0.1);
            --technical: rgba(109, 90, 207, 0.1);
            --both: rgba(13, 139, 112, 0.1);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--ui-light); color: var(--ui-dark); }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; }
        
        /* Header */
        .header {
            background: var(--ui-card);
            border-bottom: 1px solid var(--ui-border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            font-family: 'SF Mono', monospace;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--ui-dark);
            text-decoration: none;
        }
        
        /* Main Layout */
        .project-view {
            padding: 2rem 0;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
        }
        
        @media (max-width: 1024px) {
            .project-view { grid-template-columns: 1fr; }
        }
        
        /* Cards */
        .card {
            background: var(--ui-card);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid var(--ui-border);
            margin-bottom: 1.5rem;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--ui-border);
            margin-bottom: 2rem;
        }
        
        .tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            font-family: inherit;
            font-size: 1rem;
            color: var(--ui-mid);
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            color: var(--thorax-blue);
            border-bottom-color: var(--thorax-blue);
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-family: inherit;
            font-weight: 600;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--thorax-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background: #14485E;
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }
        
        .btn-secondary {
            background: var(--ui-card);
            color: var(--ui-dark);
            border: 1px solid var(--ui-border);
        }
        
        /* KNOWLEDGE BRIDGE STYLES */
        .knowledge-bridge {
            background: linear-gradient(135deg, var(--thorax-blue) 0%, var(--thorax-purple) 100%);
            color: white;
            border: none;
        }
        
        .bridge-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .bridge-icon {
            font-size: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .bridge-directions {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .bridge-direction {
            flex: 1;
            text-align: center;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bridge-direction:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .bridge-direction.active {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .bridge-input {
            width: 100%;
            padding: 1rem;
            border-radius: var(--radius);
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-family: inherit;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        
        .bridge-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .bridge-output {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            padding: 1rem;
            margin-top: 1rem;
            display: none;
        }
        
        .bridge-output.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .translation-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .badge-clinical { background: var(--clinical); color: var(--thorax-blue); }
        .badge-technical { background: var(--technical); color: var(--thorax-purple); }
        .badge-both { background: var(--both); color: var(--thorax-teal); }
        
        /* DOCUMENTATION TAGGING SYSTEM */
        .tagging-system {
            background: var(--ui-card);
            border: 1px solid var(--ui-border);
            border-radius: var(--radius);
            padding: 1rem;
        }
        
        .tag-category {
            margin-bottom: 1.5rem;
        }
        
        .category-title {
            font-weight: 600;
            color: var(--ui-dark);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .tag {
            padding: 0.5rem 1rem;
            background: var(--ui-light);
            border: 1px solid var(--ui-border);
            border-radius: 9999px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tag:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .tag.selected {
            background: var(--thorax-blue);
            color: white;
            border-color: var(--thorax-blue);
        }
        
        .tag-clinical { border-left: 4px solid var(--thorax-blue); }
        .tag-technical { border-left: 4px solid var(--thorax-purple); }
        .tag-both { border-left: 4px solid var(--thorax-teal); }
        
        .document-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .document-card {
            padding: 1rem;
            border: 1px solid var(--ui-border);
            border-radius: var(--radius);
            transition: all 0.2s;
        }
        
        .document-card:hover {
            border-color: var(--thorax-blue);
            transform: translateX(4px);
        }
        
        .document-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }
        
        /* Filter System */
        .filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--ui-card);
            border-radius: var(--radius);
            border: 1px solid var(--ui-border);
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .filter-tag {
            padding: 0.25rem 0.75rem;
            background: var(--ui-light);
            border-radius: 9999px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .remove-filter {
            cursor: pointer;
            opacity: 0.6;
        }
        
        .remove-filter:hover {
            opacity: 1;
        }
        
        /* Status Indicators */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-live { background: var(--both); color: var(--thorax-teal); }
        .status-demo { background: rgba(245, 158, 11, 0.1); color: #F59E0B; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .project-view { gap: 1rem; }
            .tabs { overflow-x: auto; }
            .tab { padding: 0.75rem 1rem; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">[THÃ˜RAX][LAB]</a>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <span class="status-badge status-demo">
                        <i class="fas fa-flask"></i>
                        Demo Mode
                    </span>
                    <button class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i>
                        Back to Dashboard
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Project Header -->
        <div style="margin: 2rem 0;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                <div>
                    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">COPD Exacerbation Prediction</h1>
                    <div style="color: var(--ui-mid); display: flex; gap: 1rem; font-size: 0.875rem;">
                        <span>Clinical-Industry Collaboration</span>
                        <span>â€¢</span>
                        <span>Started Jan 15, 2024</span>
                    </div>
                </div>
                <button class="btn btn-primary" id="uploadDocumentBtn">
                    <i class="fas fa-upload"></i>
                    Upload Document
                </button>
            </div>
            
            <div class="filter-bar" id="filterBar">
                <div style="font-weight: 600; color: var(--ui-dark);">Active Filters:</div>
                <!-- Active filters will appear here -->
                <div id="activeFilters"></div>
                <button class="btn btn-secondary" id="clearFilters" style="margin-left: auto; font-size: 0.875rem;">
                    Clear All
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="project-view">
            <!-- Left Column -->
            <div>
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="documents">
                        <i class="fas fa-file-alt"></i>
                        Documents
                    </button>
                    <button class="tab" data-tab="discussions">
                        <i class="fas fa-comments"></i>
                        Discussions
                    </button>
                    <button class="tab" data-tab="knowledge">
                        <i class="fas fa-bridge"></i>
                        Knowledge Bridge
                    </button>
                </div>

                <!-- Documents Tab -->
                <div id="documentsTab" class="tab-content active">
                    <div class="card">
                        <h2 style="margin-bottom: 1.5rem;">Project Documents</h2>
                        <p style="color: var(--ui-mid); margin-bottom: 1.5rem;">
                            Filter documents by audience, specialty, and content type. Click tags to filter.
                        </p>
                        
                        <!-- Tagging System -->
                        <div class="tagging-system">
                            <div class="tag-category">
                                <div class="category-title">
                                    <i class="fas fa-users"></i>
                                    <span>Primary Audience</span>
                                </div>
                                <div class="tag-cloud">
                                    <div class="tag tag-clinical" data-filter="audience:clinical">Clinical Team</div>
                                    <div class="tag tag-technical" data-filter="audience:technical">Technical Team</div>
                                    <div class="tag tag-both" data-filter="audience:both">Both Audiences</div>
                                    <div class="tag" data-filter="audience:regulatory">Regulatory</div>
                                </div>
                            </div>
                            
                            <div class="tag-category">
                                <div class="category-title">
                                    <i class="fas fa-stethoscope"></i>
                                    <span>Clinical Specialties</span>
                                </div>
                                <div class="tag-cloud">
                                    <div class="tag tag-clinical" data-filter="specialty:pulmonology">Pulmonology</div>
                                    <div class="tag tag-clinical" data-filter="specialty:critical-care">Critical Care</div>
                                    <div class="tag tag-clinical" data-filter="specialty:radiology">Radiology</div>
                                    <div class="tag tag-clinical" data-filter="specialty:pharmacology">Pharmacology</div>
                                </div>
                            </div>
                            
                            <div class="tag-category">
                                <div class="category-title">
                                    <i class="fas fa-cogs"></i>
                                    <span>Technical Domains</span>
                                </div>
                                <div class="tag-cloud">
                                    <div class="tag tag-technical" data-filter="domain:ml">Machine Learning</div>
                                    <div class="tag tag-technical" data-filter="domain:data">Data Engineering</div>
                                    <div class="tag tag-technical" data-filter="domain:backend">Backend Systems</div>
                                    <div class="tag tag-technical" data-filter="domain:security">Security & Compliance</div>
                                </div>
                            </div>
                            
                            <div class="tag-category">
                                <div class="category-title">
                                    <i class="fas fa-file"></i>
                                    <span>Document Types</span>
                                </div>
                                <div class="tag-cloud">
                                    <div class="tag tag-both" data-filter="type:protocol">Protocol</div>
                                    <div class="tag" data-filter="type:dataset">Dataset</div>
                                    <div class="tag tag-technical" data-filter="type:api">API Documentation</div>
                                    <div class="tag tag-clinical" data-filter="type:analysis">Clinical Analysis</div>
                                    <div class="tag" data-filter="type:regulatory">Regulatory Submission</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Document List -->
                        <div class="document-list" id="documentList" style="margin-top: 2rem;">
                            <!-- Documents will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Knowledge Bridge Tab -->
                <div id="knowledgeTab" class="tab-content">
                    <div class="card knowledge-bridge">
                        <div class="bridge-header">
                            <div class="bridge-icon">
                                <i class="fas fa-bridge"></i>
                            </div>
                            <div>
                                <h2 style="color: white; margin-bottom: 0.25rem;">Knowledge Bridge</h2>
                                <p style="color: rgba(255, 255, 255, 0.8);">Translate between clinical and technical concepts</p>
                            </div>
                        </div>
                        
                        <div class="bridge-directions">
                            <div class="bridge-direction" data-direction="clinical-to-technical">
                                <i class="fas fa-user-md"></i>
                                <div>Clinical â†’ Technical</div>
                            </div>
                            <div class="bridge-direction active" data-direction="technical-to-clinical">
                                <i class="fas fa-code"></i>
                                <div>Technical â†’ Clinical</div>
                            </div>
                            <div class="bridge-direction" data-direction="both-ways">
                                <i class="fas fa-exchange-alt"></i>
                                <div>Explain Both Ways</div>
                            </div>
                        </div>
                        
                        <input type="text" class="bridge-input" id="bridgeInput" 
                               placeholder="Enter a clinical or technical concept to translate...">
                        
                        <button class="btn btn-primary" id="translateBtn" style="width: 100%; background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3);">
                            <i class="fas fa-language"></i>
                            Translate Concept
                        </button>
                        
                        <div class="bridge-output" id="bridgeOutput">
                            <!-- Translation results will appear here -->
                        </div>
                    </div>
                    
                    <!-- Recent Translations -->
                    <div class="card">
                        <h3 style="margin-bottom: 1rem;">Recent Translations</h3>
                        <div id="translationHistory">
                            <!-- History items will appear here -->
                        </div>
                    </div>
                </div>
                
                <!-- Discussions Tab -->
                <div id="discussionsTab" class="tab-content">
                    <div class="card">
                        <h2 style="margin-bottom: 1.5rem;">Project Discussions</h2>
                        <p style="color: var(--ui-mid);">Discussion system requires backend implementation.</p>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div>
                <!-- Project Team -->
                <div class="card">
                    <h3 style="margin-bottom: 1rem;">
                        <i class="fas fa-users"></i>
                        Project Team
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--clinical); border-radius: var(--radius);">
                            <div style="width: 40px; height: 40px; background: var(--thorax-blue); border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">
                                AC
                            </div>
                            <div>
                                <div style="font-weight: 600;">Dr. Alex Chen</div>
                                <div style="font-size: 0.875rem; color: var(--ui-mid);">Lead Pulmonologist</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--technical); border-radius: var(--radius);">
                            <div style="width: 40px; height: 40px; background: var(--thorax-purple); border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600;">
                                SR
                            </div>
                            <div>
                                <div style="font-weight: 600;">Dr. Sarah Rodriguez</div>
                                <div style="font-size: 0.8758rem; color: var(--ui-mid);">ML Research Lead</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="card">
                    <h3 style="margin-bottom: 1rem;">
                        <i class="fas fa-chart-line"></i>
                        Collaboration Stats
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--ui-mid);">Clinical Inputs</span>
                                <span style="font-weight: 600; color: var(--thorax-blue);">24</span>
                            </div>
                            <div style="height: 4px; background: var(--ui-border); border-radius: 2px; margin-top: 0.25rem;">
                                <div style="width: 60%; height: 100%; background: var(--thorax-blue); border-radius: 2px;"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--ui-mid);">Technical Solutions</span>
                                <span style="font-weight: 600; color: var(--thorax-purple);">18</span>
                            </div>
                            <div style="height: 4px; background: var(--ui-border); border-radius: 2px; margin-top: 0.25rem;">
                                <div style="width: 45%; height: 100%; background: var(--thorax-purple); border-radius: 2px;"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--ui-mid);">Cross-Domain</span>
                                <span style="font-weight: 600; color: var(--thorax-teal);">12</span>
                            </div>
                            <div style="height: 4px; background: var(--ui-border); border-radius: 2px; margin-top: 0.25rem;">
                                <div style="width: 30%; height: 100%; background: var(--thorax-teal); border-radius: 2px;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <h3 style="margin-bottom: 1rem;">
                        <i class="fas fa-bolt"></i>
                        Quick Actions
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <button class="btn btn-secondary" id="quickTranslate">
                            <i class="fas fa-language"></i>
                            Quick Translation
                        </button>
                        <button class="btn btn-secondary" id="filterClinical">
                            <i class="fas fa-user-md"></i>
                            Clinical View
                        </button>
                        <button class="btn btn-secondary" id="filterTechnical">
                            <i class="fas fa-code"></i>
                            Technical View
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Upload Document Modal -->
    <div id="uploadModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 1000; padding: 1rem;">
        <div class="card" style="max-width: 500px; max-height: 90vh; overflow-y: auto; width: 100%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2>Upload New Document</h2>
                <button id="closeModal" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--ui-mid);">&times;</button>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Document Title</label>
                <input type="text" id="docTitle" style="width: 100%; padding: 0.75rem; border: 1px solid var(--ui-border); border-radius: var(--radius); font-family: inherit;">
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Select Tags</label>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                    <div class="tag selected">Clinical Team</div>
                    <div class="tag">Technical Team</div>
                    <div class="tag">Pulmonology</div>
                    <div class="tag">Machine Learning</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <button class="btn btn-secondary" id="cancelUpload">Cancel</button>
                <button class="btn btn-primary" id="submitDocument">Upload Document</button>
            </div>
        </div>
    </div>

    <script>
        // ====================
        // DOCUMENTATION SYSTEM
        // ====================
        
        class DocumentationSystem {
            constructor() {
                this.activeFilters = new Set();
                this.documents = this.getSampleDocuments();
                this.initialize();
            }
            
            initialize() {
                this.setupEventListeners();
                this.renderDocuments();
                this.updateFilterDisplay();
            }
            
            getSampleDocuments() {
                return [
                    {
                        id: 1,
                        title: "COPD Clinical Trial Protocol v2.1",
                        description: "Phase III trial design for exacerbation prediction algorithm",
                        tags: ["audience:clinical", "specialty:pulmonology", "type:protocol", "audience:both"],
                        date: "2024-01-15",
                        author: "Dr. Alex Chen",
                        badge: "clinical"
                    },
                    {
                        id: 2,
                        title: "Spirometry Data Pipeline Architecture",
                        description: "Technical specification for data ingestion and preprocessing",
                        tags: ["audience:technical", "domain:data", "type:api", "specialty:pulmonology"],
                        date: "2024-01-20",
                        author: "Sarah Rodriguez",
                        badge: "technical"
                    },
                    {
                        id: 3,
                        title: "ML Model Performance Report",
                        description: "Validation results for exacerbation prediction models",
                        tags: ["audience:both", "domain:ml", "type:analysis", "specialty:critical-care"],
                        date: "2024-01-25",
                        author: "ML Team",
                        badge: "both"
                    },
                    {
                        id: 4,
                        title: "FDA Submission Framework",
                        description: "Regulatory pathway for algorithm approval",
                        tags: ["audience:regulatory", "type:regulatory", "audience:clinical"],
                        date: "2024-01-28",
                        author: "Regulatory Team",
                        badge: "clinical"
                    },
                    {
                        id: 5,
                        title: "API Documentation v1.0",
                        description: "REST API endpoints for clinical data access",
                        tags: ["audience:technical", "domain:backend", "type:api", "domain:security"],
                        date: "2024-02-01",
                        author: "Engineering Team",
                        badge: "technical"
                    },
                    {
                        id: 6,
                        title: "Clinical Validation Study Design",
                        description: "Methodology for real-world evidence collection",
                        tags: ["audience:both", "specialty:pulmonology", "type:protocol", "domain:data"],
                        date: "2024-02-05",
                        author: "Dr. Maria Santos",
                        badge: "both"
                    }
                ];
            }
            
            setupEventListeners() {
                // Tag filtering
                document.querySelectorAll('.tag').forEach(tag => {
                    tag.addEventListener('click', (e) => {
                        const filter = e.target.dataset.filter;
                        if (filter) {
                            this.toggleFilter(filter);
                        }
                    });
                });
                
                // Clear filters
                document.getElementById('clearFilters').addEventListener('click', () => {
                    this.clearFilters();
                });
                
                // Tab switching
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const tabId = e.target.dataset.tab;
                        this.switchTab(tabId);
                    });
                });
                
                // Quick filter buttons
                document.getElementById('filterClinical').addEventListener('click', () => {
                    this.setFilter('audience:clinical');
                });
                
                document.getElementById('filterTechnical').addEventListener('click', () => {
                    this.setFilter('audience:technical');
                });
                
                // Modal controls
                const modal = document.getElementById('uploadModal');
                document.getElementById('uploadDocumentBtn').addEventListener('click', () => {
                    modal.style.display = 'flex';
                });
                
                document.getElementById('closeModal').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                document.getElementById('cancelUpload').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                document.getElementById('submitDocument').addEventListener('click', () => {
                    this.addDocument();
                    modal.style.display = 'none';
                });
                
                // Close modal on outside click
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }
            
            toggleFilter(filter) {
                if (this.activeFilters.has(filter)) {
                    this.activeFilters.delete(filter);
                } else {
                    this.activeFilters.add(filter);
                }
                
                this.updateFilterDisplay();
                this.renderDocuments();
            }
            
            setFilter(filter) {
                this.activeFilters.clear();
                this.activeFilters.add(filter);
                this.updateFilterDisplay();
                this.renderDocuments();
            }
            
            clearFilters() {
                this.activeFilters.clear();
                this.updateFilterDisplay();
                this.renderDocuments();
            }
            
            updateFilterDisplay() {
                const container = document.getElementById('activeFilters');
                container.innerHTML = '';
                
                if (this.activeFilters.size === 0) {
                    document.getElementById('filterBar').style.display = 'none';
                    return;
                }
                
                document.getElementById('filterBar').style.display = 'flex';
                
                this.activeFilters.forEach(filter => {
                    const [type, value] = filter.split(':');
                    const filterElement = document.createElement('div');
                    filterElement.className = 'filter-tag';
                    filterElement.innerHTML = `
                        ${this.getFilterIcon(type)}
                        ${this.formatFilterName(type, value)}
                        <span class="remove-filter" data-filter="${filter}">&times;</span>
                    `;
                    container.appendChild(filterElement);
                });
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-filter').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const filter = e.target.dataset.filter;
                        this.activeFilters.delete(filter);
                        this.updateFilterDisplay();
                        this.renderDocuments();
                    });
                });
            }
            
            getFilterIcon(type) {
                const icons = {
                    'audience': 'fas fa-users',
                    'specialty': 'fas fa-stethoscope',
                    'domain': 'fas fa-cogs',
                    'type': 'fas fa-file'
                };
                return `<i class="${icons[type] || 'fas fa-tag'}" style="font-size: 0.75rem;"></i>`;
            }
            
            formatFilterName(type, value) {
                const names = {
                    'clinical': 'Clinical Team',
                    'technical': 'Technical Team',
                    'both': 'Both Audiences',
                    'regulatory': 'Regulatory',
                    'pulmonology': 'Pulmonology',
                    'ml': 'Machine Learning',
                    'protocol': 'Protocol',
                    'analysis': 'Analysis'
                };
                return names[value] || value;
            }
            
            renderDocuments() {
                const container = document.getElementById('documentList');
                const filteredDocs = this.getFilteredDocuments();
                
                if (filteredDocs.length === 0) {
                    container.innerHTML = `
                        <div class="card" style="text-align: center; padding: 3rem;">
                            <div style="font-size: 3rem; color: var(--ui-mid); margin-bottom: 1rem;">ðŸ“‚</div>
                            <h3 style="margin-bottom: 0.5rem;">No Documents Match Filters</h3>
                            <p style="color: var(--ui-mid); margin-bottom: 1.5rem;">Try adjusting your filter criteria</p>
                            <button class="btn btn-secondary" id="clearFiltersInline">Clear Filters</button>
                        </div>
                    `;
                    
                    document.getElementById('clearFiltersInline').addEventListener('click', () => {
                        this.clearFilters();
                    });
                    
                    return;
                }
                
                container.innerHTML = filteredDocs.map(doc => `
                    <div class="document-card">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem;">
                            <h4 style="font-weight: 600;">${doc.title}</h4>
                            <span class="translation-badge badge-${doc.badge}">
                                ${doc.badge === 'clinical' ? 'Clinical' : doc.badge === 'technical' ? 'Technical' : 'Both'}
                            </span>
                        </div>
                        
                        <p style="color: var(--ui-mid); font-size: 0.875rem; margin-bottom: 0.75rem;">
                            ${doc.description}
                        </p>
                        
                        <div class="document-tags">
                            ${doc.tags.map(tag => {
                                const [type, value] = tag.split(':');
                                return `<span class="tag" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;" data-filter="${tag}">
                                    ${this.getFilterIcon(type)} ${this.formatFilterName(type, value)}
                                </span>`;
                            }).join('')}
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-top: 1rem; font-size: 0.75rem; color: var(--ui-mid);">
                            <span>By ${doc.author}</span>
                            <span>${doc.date}</span>
                        </div>
                    </div>
                `).join('');
                
                // Re-add event listeners to tags in documents
                container.querySelectorAll('.tag').forEach(tag => {
                    tag.addEventListener('click', (e) => {
                        const filter = e.target.dataset.filter;
                        if (filter) {
                            this.toggleFilter(filter);
                        }
                    });
                });
            }
            
            getFilteredDocuments() {
                if (this.activeFilters.size === 0) {
                    return this.documents;
                }
                
                return this.documents.filter(doc => {
                    return Array.from(this.activeFilters).every(filter => 
                        doc.tags.includes(filter)
                    );
                });
            }
            
            switchTab(tabId) {
                // Update active tab
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.tab === tabId);
                });
                
                // Update active content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.toggle('active', content.id === `${tabId}Tab`);
                });
            }
            
            addDocument() {
                const title = document.getElementById('docTitle').value.trim();
                if (!title) return;
                
                const newDoc = {
                    id: this.documents.length + 1,
                    title: title,
                    description: "Newly uploaded document - add description in full implementation",
                    tags: ["audience:both", "type:protocol"],
                    date: new Date().toISOString().split('T')[0],
                    author: "Current User",
                    badge: "both"
                };
                
                this.documents.unshift(newDoc);
                this.renderDocuments();
                document.getElementById('docTitle').value = '';
            }
        }
        
        // ====================
        // KNOWLEDGE BRIDGE
        // ====================
        
        class KnowledgeBridge {
            constructor() {
                this.direction = 'technical-to-clinical';
                this.history = [];
                this.initialize();
            }
            
            initialize() {
                this.setupEventListeners();
                this.loadSampleHistory();
            }
            
            setupEventListeners() {
                // Direction selection
                document.querySelectorAll('.bridge-direction').forEach(dir => {
                    dir.addEventListener('click', (e) => {
                        this.setDirection(e.currentTarget.dataset.direction);
                    });
                });
                
                // Translation button
                document.getElementById('translateBtn').addEventListener('click', () => {
                    this.performTranslation();
                });
                
                // Quick translate
                document.getElementById('quickTranslate').addEventListener('click', () => {
                    this.switchToKnowledgeTab();
                    document.getElementById('bridgeInput').value = "FEV1 variability over time";
                    setTimeout(() => this.performTranslation(), 100);
                });
                
                // Enter key in input
                document.getElementById('bridgeInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.performTranslation();
                    }
                });
            }
            
            setDirection(direction) {
                this.direction = direction;
                
                // Update UI
                document.querySelectorAll('.bridge-direction').forEach(dir => {
                    dir.classList.toggle('active', dir.dataset.direction === direction);
                });
                
                // Update placeholder
                const input = document.getElementById('bridgeInput');
                const placeholders = {
                    'clinical-to-technical': 'Enter a clinical concept (e.g., "COPD exacerbation")...',
                    'technical-to-clinical': 'Enter a technical concept (e.g., "random forest classifier")...',
                    'both-ways': 'Enter any concept to see both perspectives...'
                };
                input.placeholder = placeholders[direction] || 'Enter a concept to translate...';
            }
            
            performTranslation() {
                const input = document.getElementById('bridgeInput').value.trim();
                if (!input) return;
                
                const translation = this.generateTranslation(input);
                this.displayTranslation(translation);
                this.addToHistory(input, translation);
            }
            
            generateTranslation(input) {
                const translations = {
                    // Clinical to Technical
                    'COPD exacerbation': {
                        technical: "Time-series classification of multivariate physiological signals for early detection of chronic obstructive pulmonary disease deterioration events.",
                        clinical: "A sudden worsening of COPD symptoms requiring medical intervention.",
                        analogy: "Like a weather forecast predicting storms before they hit, but for lung function."
                    },
                    'FEV1 variability': {
                        technical: "Standard deviation in forced expiratory volume measurements over time, used as a feature in respiratory disease progression models.",
                        clinical: "Changes in how much air a patient can forcefully exhale in one second, indicating lung function stability.",
                        analogy: "Like monitoring battery life degradation patterns in smartphones."
                    },
                    'spirometry data': {
                        technical: "Time-series pulmonary function test results including flow-volume loops, FVC, FEV1, and PEF metrics for respiratory analytics.",
                        clinical: "Breathing test results that measure how well lungs are working.",
                        analogy: "Like a car's diagnostic report showing engine performance metrics."
                    },
                    
                    // Technical to Clinical
                    'random forest classifier': {
                        clinical: "A decision-making tool that combines multiple expert opinions to predict medical outcomes more accurately.",
                        technical: "Ensemble learning method using multiple decision trees for classification tasks.",
                        analogy: "Like getting a second (and third, and fourth) opinion from different specialists."
                    },
                    'anomaly detection': {
                        clinical: "Spotting unusual patterns in patient data that might indicate early signs of health problems.",
                        technical: "Identification of rare items, events or observations which differ significantly from the majority of the data.",
                        analogy: "Like a nurse noticing subtle changes in a patient's condition before vital signs change dramatically."
                    },
                    'feature engineering': {
                        clinical: "Creating meaningful measurements from raw patient data that help predict health outcomes.",
                        technical: "Process of using domain knowledge to create features that make machine learning algorithms work better.",
                        analogy: "Like a chef preparing ingredients in specific ways to make a better dish."
                    }
                };
                
                // Find best match
                let bestMatch = null;
                for (const [key, value] of Object.entries(translations)) {
                    if (input.toLowerCase().includes(key.toLowerCase())) {
                        bestMatch = { term: key, ...value };
                        break;
                    }
                }
                
                // If no match, generate a dynamic translation
                if (!bestMatch) {
                    return this.generateDynamicTranslation(input);
                }
                
                return bestMatch;
            }
            
            generateDynamicTranslation(input) {
                const isClinical = this.looksClinical(input);
                
                return {
                    term: input,
                    technical: isClinical ? 
                        `Technical implementation would involve ${input.toLowerCase()} monitoring through sensor data analysis, predictive modeling, and automated alert systems.` :
                        `${input} involves algorithm design, data pipeline construction, validation protocols, and deployment infrastructure.`,
                    clinical: !isClinical ?
                        `Clinically, ${input.toLowerCase()} helps monitor patient health, predict deterioration, and guide treatment decisions.` :
                        `${input} is assessed through patient symptoms, diagnostic tests, treatment response, and long-term outcomes.`,
                    analogy: isClinical ?
                        "Like a car's dashboard warning lights - early indicators that maintenance is needed." :
                        "Like building a bridge - requires solid foundations, careful engineering, and regular inspections."
                };
            }
            
            looksClinical(text) {
                const clinicalTerms = ['patient', 'symptom', 'treatment', 'clinical', 'disease', 'therapy', 'medical', 'health', 'care'];
                return clinicalTerms.some(term => text.toLowerCase().includes(term));
            }
            
            displayTranslation(translation) {
                const output = document.getElementById('bridgeOutput');
                
                let content = '';
                
                if (this.direction === 'both-ways') {
                    content = `
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span class="translation-badge badge-clinical">Clinical Perspective</span>
                                <i class="fas fa-arrow-right"></i>
                                <span class="translation-badge badge-technical">Technical Perspective</span>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                <strong>${translation.term}</strong>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <div class="translation-badge badge-clinical" style="margin-bottom: 0.5rem;">Clinical View</div>
                                    <p style="font-size: 0.875rem;">${translation.clinical}</p>
                                </div>
                                <div>
                                    <div class="translation-badge badge-technical" style="margin-bottom: 0.5rem;">Technical View</div>
                                    <p style="font-size: 0.875rem;">${translation.technical}</p>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (this.direction === 'clinical-to-technical') {
                    content = `
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span class="translation-badge badge-clinical">Clinical</span>
                                <i class="fas fa-arrow-right"></i>
                                <span class="translation-badge badge-technical">Technical</span>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                <strong>${translation.term}</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.875rem;">${translation.clinical}</p>
                            </div>
                            <div>
                                <div class="translation-badge badge-technical" style="margin-bottom: 0.5rem;">Technical Translation</div>
                                <p>${translation.technical}</p>
                            </div>
                        </div>
                    `;
                } else {
                    content = `
                        <div style="margin-bottom: 1.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span class="translation-badge badge-technical">Technical</span>
                                <i class="fas fa-arrow-right"></i>
                                <span class="translation-badge badge-clinical">Clinical</span>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
                                <strong>${translation.term}</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.875rem;">${translation.technical}</p>
                            </div>
                            <div>
                                <div class="translation-badge badge-clinical" style="margin-bottom: 0.5rem;">Clinical Translation</div>
                                <p>${translation.clinical}</p>
                            </div>
                        </div>
                    `;
                }
                
                // Add analogy if available
                if (translation.analogy) {
                    content += `
                        <div style="border-top: 1px solid rgba(255, 255, 255, 0.2); padding-top: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <i class="fas fa-lightbulb" style="color: #FBBF24;"></i>
                                <div class="translation-badge" style="background: rgba(251, 191, 36, 0.2); color: #FBBF24;">Analogy</div>
                            </div>
                            <p style="font-size: 0.875rem; font-style: italic;">"${translation.analogy}"</p>
                        </div>
                    `;
                }
                
                output.innerHTML = content;
                output.classList.add('show');
                
                // Scroll to output
                output.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            
            addToHistory(input, translation) {
                const historyItem = {
                    input,
                    translation,
                    direction: this.direction,
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };
                
                this.history.unshift(historyItem);
                if (this.history.length > 5) this.history.pop();
                
                this.updateHistoryDisplay();
            }
            
            loadSampleHistory() {
                this.history = [
                    {
                        input: "random forest classifier",
                        translation: this.generateTranslation("random forest classifier"),
                        direction: "technical-to-clinical",
                        timestamp: "10:30 AM"
                    },
                    {
                        input: "spirometry data quality",
                        translation: this.generateTranslation("spirometry data"),
                        direction: "both-ways",
                        timestamp: "09:45 AM"
                    }
                ];
                
                this.updateHistoryDisplay();
            }
            
            updateHistoryDisplay() {
                const container = document.getElementById('translationHistory');
                
                if (this.history.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: var(--ui-mid);">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ’­</div>
                            <p>No translations yet</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = this.history.map(item => `
                    <div style="padding: 0.75rem; border-bottom: 1px solid var(--ui-border);">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.25rem;">
                            <div style="font-weight: 600; font-size: 0.875rem;">${item.input}</div>
                            <div style="font-size: 0.75rem; color: var(--ui-mid);">${item.timestamp}</div>
                        </div>
                        <div style="font-size: 0.75rem; color: var(--ui-mid);">
                            ${item.direction === 'clinical-to-technical' ? 'Clinical â†’ Technical' : 
                              item.direction === 'technical-to-clinical' ? 'Technical â†’ Clinical' : 'Both Directions'}
                        </div>
                    </div>
                `).join('');
            }
            
            switchToKnowledgeTab() {
                // Simulate clicking the knowledge tab
                document.querySelector('[data-tab="knowledge"]').click();
            }
        }
        
        // ====================
        // INITIALIZATION
        // ====================
        
        document.addEventListener('DOMContentLoaded', () => {
            window.docs = new DocumentationSystem();
            window.bridge = new KnowledgeBridge();
            
            // Initialize filter bar visibility
            document.getElementById('filterBar').style.display = 'none';
        });
    </script>
</body>
</html>
